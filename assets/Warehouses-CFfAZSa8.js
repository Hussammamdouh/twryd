import{r as o,a as M,u as L,j as e,R as F}from"./index-Cclg67os.js";import{g as $,a as D,p as q,d as H,b as _}from"./api-BUuAVsLY.js";import{M as O}from"./Modal-DoRxSVjK.js";import{C as T}from"./ConfirmModal-Dok-e16l.js";import{S as k}from"./Spinner-BtaP2GZ9.js";function B({open:m,onClose:j,onSubmit:g,initialData:d,loading:x}){const[r,b]=o.useState({name:"",address:"",phone:""}),[s,i]=o.useState({});F.useEffect(()=>{m&&(b(d||{name:"",address:"",phone:""}),i({}))},[m,d]);const c=a=>{const{name:h,value:y}=a.target;b(l=>({...l,[h]:y})),i(l=>{if(l[h]){const n={...l};return delete n[h],n}return l})},N=()=>{const a={};return r.name.trim()||(a.name="Name is required"),r.address.trim()||(a.address="Address is required"),r.phone.trim()||(a.phone="Phone is required"),r.phone&&!/^[0-9+\-\s()]+$/.test(r.phone)&&(a.phone="Invalid phone number format"),i(a),Object.keys(a).length===0},u=a=>{a.preventDefault(),N()&&g(r)};return e.jsx(O,{open:m,onClose:j,title:d?"Edit Warehouse":"Add Warehouse",children:e.jsxs("form",{onSubmit:u,className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-theme-text mb-1",children:"Warehouse Name *"}),e.jsx("input",{id:"name",name:"name",type:"text",value:r.name,onChange:c,required:!0,placeholder:"Enter warehouse name",className:`theme-input w-full px-3 py-2 rounded ${s.name?"border-red-300":""}`}),s.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-theme-text mb-1",children:"Address *"}),e.jsx("input",{id:"address",name:"address",type:"text",value:r.address,onChange:c,required:!0,placeholder:"Enter warehouse address",className:`theme-input w-full px-3 py-2 rounded ${s.address?"border-red-300":""}`}),s.address&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.address})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-theme-text mb-1",children:"Phone Number *"}),e.jsx("input",{id:"phone",name:"phone",type:"tel",value:r.phone,onChange:c,required:!0,placeholder:"Enter phone number",className:`theme-input w-full px-3 py-2 rounded ${s.phone?"border-red-300":""}`}),s.phone&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.phone})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:j,className:"theme-button-secondary flex-1 py-2 px-4 rounded transition",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:x,className:"theme-button flex-1 py-2 px-4 rounded disabled:opacity-60 transition",children:x?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(k,{size:16}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):d?"Update Warehouse":"Add Warehouse"})]})]})})}function G(){const[m,j]=o.useState([]),[g,d]=o.useState(!0),[x,r]=o.useState(""),[b,s]=o.useState(!1),[i,c]=o.useState(null),[N,u]=o.useState(!1),[a,h]=o.useState(null),[y,l]=o.useState(!1),n=M(),{token:p}=L(),v=async()=>{d(!0),r("");try{const t=await $("/api/supplier/warehouses",{token:p}),f=Array.isArray(t.data)?t.data:t.data?.data||[];j(f)}catch(t){r(t.message||"Failed to load warehouses"),n.show(t.message||"Failed to load warehouses","error")}finally{d(!1)}};o.useEffect(()=>{v()},[]);const w=async t=>{l(!0);try{i?(await D(`/api/supplier/warehouses/${i.id}`,{data:t,token:p}),n.show("Warehouse updated successfully!","success")):(await q("/api/supplier/warehouses",{data:t,token:p}),n.show("Warehouse created successfully!","success")),s(!1),c(null),v()}catch(f){n.show(f.message||"Failed to save warehouse","error")}finally{l(!1)}},S=async()=>{l(!0);try{await H(`/api/supplier/warehouses/${a.id}`,{token:p}),n.show("Warehouse deleted successfully!","success"),u(!1),h(null),v()}catch(t){n.show(t.message||"Failed to delete warehouse","error")}finally{l(!1)}},W=async t=>{try{await _(`/api/supplier/warehouses/${t.id}/toggle`,{token:p}),n.show(`Warehouse ${t.is_active?"deactivated":"activated"} successfully!`,"success"),v()}catch(f){n.show(f.message||"Failed to toggle warehouse status","error")}},C=()=>{c(null),s(!0)},A=t=>{c(t),s(!0)},E=t=>{h(t),u(!0)};return g?e.jsx("div",{className:"w-full max-w-5xl mx-auto py-8 px-2",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(k,{size:32})})}):e.jsxs("div",{className:"w-full max-w-5xl mx-auto py-8 px-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-primary-700",children:"Warehouses"}),e.jsx("p",{className:"text-theme-text-secondary mt-1",children:"Manage your warehouse locations"})]}),e.jsxs("button",{onClick:C,className:"theme-button px-5 py-2 rounded font-bold transition flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Warehouse"]})]}),x&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg dark:bg-red-900/30 dark:border-red-700",children:e.jsx("p",{className:"text-red-600 dark:text-red-300",children:x})}),e.jsx("div",{className:"theme-card p-3 sm:p-6 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"theme-table-header text-primary-700",children:[e.jsx("th",{className:"py-3 px-4 text-left font-semibold",children:"Name"}),e.jsx("th",{className:"py-3 px-4 text-left font-semibold",children:"Address"}),e.jsx("th",{className:"py-3 px-4 text-left font-semibold",children:"Phone"}),e.jsx("th",{className:"py-3 px-4 text-left font-semibold",children:"Status"}),e.jsx("th",{className:"py-3 px-4 text-right font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[m.map(t=>e.jsxs("tr",{className:"border-b border-theme-border last:border-b-0 hover:bg-theme-surface",children:[e.jsx("td",{className:"py-3 px-4 font-semibold text-theme-text",children:t.name}),e.jsx("td",{className:"py-3 px-4 text-theme-text",children:t.address}),e.jsx("td",{className:"py-3 px-4 text-theme-text",children:t.phone}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-bold ${t.is_active?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-gray-200 text-gray-500 dark:bg-gray-700 dark:text-gray-300"}`,children:t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>W(t),className:`px-3 py-1 rounded text-xs font-medium transition ${t.is_active?"bg-orange-100 text-orange-700 hover:bg-orange-200 dark:bg-orange-900/30 dark:text-orange-300":"bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/30 dark:text-green-300"}`,title:t.is_active?"Deactivate":"Activate",children:t.is_active?"Deactivate":"Activate"}),e.jsx("button",{onClick:()=>A(t),className:"text-primary-600 hover:text-primary-800 transition px-2 py-1",title:"Edit",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>E(t),className:"text-red-600 hover:text-red-800 transition px-2 py-1",title:"Delete",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},t.id)),m.length===0&&!g&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-12 text-center text-theme-text-muted",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("svg",{className:"w-12 h-12 text-theme-text-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.jsx("p",{className:"text-lg font-medium",children:"No warehouses found"}),e.jsx("p",{className:"text-sm",children:"Get started by adding your first warehouse"})]})})})]})]})}),e.jsx(B,{open:b,onClose:()=>s(!1),onSubmit:w,initialData:i,loading:y}),e.jsx(T,{open:N,onClose:()=>u(!1),onConfirm:S,title:"Delete Warehouse",message:`Are you sure you want to delete "${a?.name}"? This action cannot be undone.`,loading:y})]})}export{G as default};
