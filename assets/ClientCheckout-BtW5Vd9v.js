import{u as v,a as N,r as i,R as w,j as e,L as u}from"./index-Cclg67os.js";import{g as L,p as C}from"./api-BUuAVsLY.js";import{S as M}from"./Spinner-BtaP2GZ9.js";function B(){const{token:n}=v(),d=N(),[s,y]=i.useState(null),[g,c]=i.useState(!0),[l,x]=i.useState({}),[m,k]=i.useState({}),[o,h]=i.useState({}),p=async()=>{c(!0);try{const r=await L("/api/client/cart",{token:n});y(r.data?.cart||null)}catch(r){d.show(r.message||"Failed to load cart","error")}finally{c(!1)}};i.useEffect(()=>{p()},[]);const j=w.useMemo(()=>!s||!s.items?[]:[{supplier_id:s.supplier?.id||"unknown",supplier:s.supplier,items:s.items}],[s]),f=async r=>{x(t=>({...t,[r]:!0})),h(t=>({...t,[r]:!1}));try{const t=await C("/api/client/orders/submit",{token:n,data:{supplier_id:r,notes:m[r]||""}}),a=t?.data?.id||t?.data?.order_id;h(b=>({...b,[r]:!0})),d.show("Order submitted!","success"),p(),a&&(window.location.href=`/client/dashboard/order-confirmation/${a}`)}catch(t){d.show(t.message||"Failed to submit order","error")}finally{x(t=>({...t,[r]:!1}))}};return g?e.jsx(M,{}):!s||!s.items||s.items.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-24",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m6-5v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6m8 0V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4.01"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Your cart is empty"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Add products to your cart to proceed to checkout."}),e.jsx(u,{to:"/client/dashboard/my-marketplace",className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 font-semibold",children:"Go to Marketplace"})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-extrabold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-primary-100 dark:bg-primary-900/30 rounded-xl",children:e.jsx("svg",{className:"w-6 h-6 text-primary-600 dark:text-primary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Checkout"}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400 font-normal text-lg sm:text-xl ml-2",children:"Complete your order"})]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Review your order details and place your order."})]}),j.map(r=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-primary-50 to-primary-100 dark:from-primary-900/20 dark:to-primary-800/20 px-6 py-4 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-primary-600 dark:text-primary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Supplier: ",r.supplier?.name||"Unknown"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.supplier?.email||""})]}),o[r.supplier_id]&&e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-green-600 font-semibold",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Order placed!"]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[e.jsx("th",{className:"p-3 text-left font-semibold text-gray-700 dark:text-gray-300",children:"Product"}),e.jsx("th",{className:"p-3 text-center font-semibold text-gray-700 dark:text-gray-300",children:"Qty"}),e.jsx("th",{className:"p-3 text-center font-semibold text-gray-700 dark:text-gray-300",children:"Price"}),e.jsx("th",{className:"p-3 text-center font-semibold text-gray-700 dark:text-gray-300",children:"Discount"}),e.jsx("th",{className:"p-3 text-center font-semibold text-gray-700 dark:text-gray-300",children:"Subtotal"})]})}),e.jsx("tbody",{children:r.items.map(t=>e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-600",children:[e.jsxs("td",{className:"p-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 dark:bg-gray-600 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.product?.name||"Unknown Product"}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["SKU: ",t.product?.id||"N/A"]})]})]}),e.jsx("td",{className:"p-3 text-center text-gray-900 dark:text-white font-medium",children:t.quantity}),e.jsxs("td",{className:"p-3 text-center text-gray-900 dark:text-white",children:["$",parseFloat(t.unit_price||0).toFixed(2)]}),e.jsx("td",{className:"p-3 text-center text-gray-900 dark:text-white",children:t.product?.base_discount?`${t.product.base_discount}%`:"-"}),e.jsxs("td",{className:"p-3 text-center font-semibold text-primary-600 dark:text-primary-400",children:["$",parseFloat(t.total_price||0).toFixed(2)]})]},t.id))})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Order Notes (Optional)"}),e.jsx("textarea",{className:"w-full border border-gray-300 dark:border-gray-600 rounded-xl p-3 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200",rows:3,placeholder:"Add any special instructions or notes for this order...",value:m[r.supplier_id]||"",onChange:t=>k(a=>({...a,[r.supplier_id]:t.target.value})),disabled:l[r.supplier_id]||o[r.supplier_id]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-4",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-primary-600 dark:text-primary-400",children:["$",r.items.reduce((t,a)=>t+parseFloat(a.total_price||0),0).toFixed(2)]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total for this supplier"})]})}),e.jsx("button",{className:"bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white font-semibold py-3 px-8 rounded-xl shadow-lg disabled:opacity-60 transition-all duration-200 flex items-center gap-2",disabled:l[r.supplier_id]||o[r.supplier_id],onClick:()=>f(r.supplier_id),children:l[r.supplier_id]?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Placing Order..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Place Order"]})})]})]})]})]},r.supplier_id)),e.jsx("div",{className:"text-center mt-8",children:e.jsxs(u,{to:"/client/dashboard/cart",className:"inline-flex items-center gap-2 text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-semibold transition-colors duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Cart"]})})]})}export{B as default};
