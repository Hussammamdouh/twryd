import{k as P,u as A,a as M,b as E,A as I,r as s,j as e,L as V}from"./index-BBFhNgLA.js";import{g as w,p as z}from"./api-BUuAVsLY.js";import{S as C}from"./Spinner-DiswAH3X.js";function R(){const{productId:n}=P(),{token:i}=A(),g=M(),u=E(),b=I(),[t,h]=s.useState(null),[S,p]=s.useState(!0),[y,c]=s.useState(1),[j,f]=s.useState(!1),[d,o]=s.useState("description"),[N,k]=s.useState([]),[v,_]=s.useState([]),[m,x]=s.useState("");s.useEffect(()=>{p(!0),w(`/api/client-management/products/${n}`,{token:i}).then(a=>h(a.data||a.data?.product||null)).catch(()=>h(null)).finally(()=>p(!1))},[n,i]),s.useEffect(()=>{t?.category_id&&w(`/api/client-management/products-by-category/${t.category_id}`,{token:i}).then(a=>k((a.data?.products||a.data||[]).filter(r=>r.id!==t.id))).catch(()=>k([]))},[t,i]),s.useEffect(()=>{if(t){let a=JSON.parse(localStorage.getItem("recently_viewed_products")||"[]");a=a.filter(r=>r.id!==t.id),a.unshift(t),a.length>8&&(a=a.slice(0,8)),localStorage.setItem("recently_viewed_products",JSON.stringify(a)),_(a.filter(r=>r.id!==t.id))}},[t]);const l=t&&t.images&&Array.isArray(t.images)&&t.images.length>0?t.images:t&&t.image_url?[t.image_url]:[];if(s.useEffect(()=>{l&&l.length>0?x(l[0]):x("")},[n,l]),S)return e.jsx("div",{className:"flex justify-center py-24",children:e.jsx(C,{size:32})});if(!t)return e.jsx("div",{className:"text-center text-red-500 py-24",children:"Product not found or unavailable."});const L=(t.price-t.price*(t.discount||0)/100).toFixed(2),$=async()=>{f(!0);try{await z("/api/client/cart/items",{token:i,data:{product_id:t.id,quantity:y}}),g.show("Added to cart!","success"),b.invalidateQueries(["client-cart"]),b.invalidateQueries(["cart"])}catch(a){g.show(a.message||"Failed to add to cart","error")}finally{f(!1)}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-extrabold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-primary-100 dark:bg-primary-900/30 rounded-xl",children:e.jsx("svg",{className:"w-6 h-6 text-primary-600 dark:text-primary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7V6a2 2 0 012-2h14a2 2 0 012 2v1M5 7h14l1 5H4l1-5zm2 8a2 2 0 104 0 2 2 0 00-4 0zm10 0a2 2 0 104 0 2 2 0 00-4 0z"})})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Product Details"}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400 font-normal text-lg sm:text-xl ml-2",children:"View and purchase this product"})]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"See product information, supplier details, and related products."})]}),e.jsxs("nav",{className:"text-xs text-gray-500 mb-4 flex items-center gap-2",children:[e.jsx(V,{to:"/client/dashboard/my-marketplace",className:"hover:underline",children:"Marketplace"}),e.jsx("span",{children:"/"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:t.name})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 flex flex-col md:flex-row gap-8 mb-8",children:[e.jsxs("div",{className:"flex flex-col items-center md:w-1/2",children:[e.jsx("div",{className:"w-64 h-64 bg-gray-100 dark:bg-gray-700 rounded flex items-center justify-center mb-4",children:m?e.jsx("img",{src:m,alt:t.name,className:"max-h-60 object-contain"}):e.jsx("div",{className:"w-32 h-32 bg-gray-200 dark:bg-gray-600 rounded"})}),e.jsx("div",{className:"flex gap-2 mt-2",children:l.map((a,r)=>e.jsx("button",{onClick:()=>x(a),className:`w-12 h-12 rounded border ${m===a?"border-blue-500":"border-gray-300 dark:border-gray-600"}`,children:e.jsx("img",{src:a,alt:"thumb",className:"w-full h-full object-contain rounded"})},r))})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2 text-gray-900 dark:text-white",children:t.name}),e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("span",{className:"text-primary-600 font-bold text-2xl",children:["$",L]}),t.discount>0&&e.jsxs("span",{className:"line-through text-gray-400 text-lg",children:["$",t.price]}),t.discount>0&&e.jsxs("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-1 rounded",children:["-",t.discount,"% Off"]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["by ",t.supplier_name||t.supplier?.name||"Unknown"]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("label",{className:"text-sm",children:"QUANTITY"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-lg font-bold",onClick:()=>c(a=>Math.max(1,a-1)),"aria-label":"Decrease quantity",children:"-"}),e.jsx("input",{type:"number",min:1,value:y,onChange:a=>c(Math.max(1,Number(a.target.value))),className:"w-16 px-2 py-1 border rounded text-center bg-white dark:bg-gray-700 text-gray-900 dark:text-white border-gray-300 dark:border-gray-600"}),e.jsx("button",{type:"button",className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-lg font-bold",onClick:()=>c(a=>a+1),"aria-label":"Increase quantity",children:"+"})]})]}),e.jsx("div",{className:"flex gap-2 mb-4",children:e.jsxs("button",{className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg flex items-center gap-2 disabled:opacity-60",onClick:$,disabled:j,children:[j?e.jsx(C,{size:16,color:"border-white"}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.35 2.7A2 2 0 007.48 19h9.04a2 2 0 001.83-2.7L17 13M7 13V6a1 1 0 011-1h5a1 1 0 011 1v7"})}),"Add to Cart"]})}),e.jsx("div",{className:"flex gap-2 text-gray-400 text-lg",children:t.product_url&&e.jsx("a",{href:t.product_url,target:"_blank",rel:"noopener noreferrer",title:"Product Link",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 010 5.656m-1.414-1.414a2 2 0 010-2.828m-2.828 2.828a4 4 0 010-5.656m1.414 1.414a2 2 0 010 2.828"})})})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8",children:[e.jsxs("div",{className:"flex gap-6 border-b mb-4",children:[e.jsx("button",{className:`pb-2 font-semibold ${d==="description"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500"}`,onClick:()=>o("description"),children:"Product Description"}),e.jsx("button",{className:`pb-2 font-semibold ${d==="supplier"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500"}`,onClick:()=>o("supplier"),children:"Supplier Details"}),e.jsx("button",{className:`pb-2 font-semibold ${d==="related"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500"}`,onClick:()=>o("related"),children:"Related Products"})]}),d==="description"&&e.jsx("div",{children:e.jsx("div",{className:"mb-2 text-sm text-gray-700 dark:text-gray-200",children:t.description||"No description available."})}),d==="supplier"&&e.jsx("div",{children:e.jsxs("div",{className:"mb-2 text-sm text-gray-700 dark:text-gray-200",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Supplier Name:"})," ",t.supplier?.name||t.supplier_name||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Supplier Email:"})," ",t.supplier?.email||"N/A"]})]})}),d==="related"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[N.length===0&&e.jsx("div",{className:"col-span-2 text-gray-400",children:"No related products found."}),N.slice(0,4).map(a=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 flex flex-col",children:[e.jsx("div",{className:"h-24 flex items-center justify-center mb-2 bg-gray-100 dark:bg-gray-600 rounded",children:a.image_url?e.jsx("img",{src:a.image_url,alt:a.name,className:"max-h-20 object-contain"}):e.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-500 rounded"})}),e.jsx("div",{className:"font-semibold mb-1",children:a.name}),e.jsxs("div",{className:"text-primary-600 font-bold mb-1",children:["$",(a.price-a.price*(a.discount||0)/100).toFixed(2)]}),e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-1 rounded mt-auto",onClick:()=>u(`/client/dashboard/my-marketplace/product/${a.id}`),children:"View Product"})]},a.id))]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8",children:[e.jsx("h3",{className:"font-semibold mb-4 text-gray-900 dark:text-white",children:"Recently Viewed Products"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[v.length===0&&e.jsx("div",{className:"col-span-2 text-gray-400",children:"No recently viewed products."}),v.slice(0,4).map(a=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 flex flex-col",children:[e.jsx("div",{className:"h-24 flex items-center justify-center mb-2 bg-gray-100 dark:bg-gray-600 rounded",children:a.image_url?e.jsx("img",{src:a.image_url,alt:a.name,className:"max-h-20 object-contain"}):e.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-500 rounded"})}),e.jsx("div",{className:"font-semibold mb-1",children:a.name}),e.jsxs("div",{className:"text-primary-600 font-bold mb-1",children:["$",(a.price-a.price*(a.discount||0)/100).toFixed(2)]}),e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-1 rounded mt-auto",onClick:()=>u(`/client/dashboard/my-marketplace/product/${a.id}`),children:"View Product"})]},a.id))]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold mb-2 text-gray-900 dark:text-white",children:"Shipping Information"}),e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:[e.jsx("div",{children:"Estimated shipping: 2-5 business days."}),e.jsx("div",{children:"Free shipping on orders over $50."}),e.jsx("div",{children:"Extra charges may be applicable for an additional fee."})]})]})]})}export{R as default};
