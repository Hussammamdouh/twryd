import{u as S,a as P,r as d,j as e,g as A}from"./index-Cclg67os.js";import{g as L,a as D}from"./api-BUuAVsLY.js";function q(){const{user:g,logout:v,token:m}=S(),c=P(),[t,b]=d.useState(null),[y,f]=d.useState(!0),[x,j]=d.useState(!1),[n,u]=d.useState(!1),[r,o]=d.useState({name:"",email:"",phone:"",whatsapp:"",tax_card_number:"",cr_number:"",latitude:"",longitude:"",area_id:""}),[l,h]=d.useState({});d.useEffect(()=>{m&&_()},[m]);const _=async()=>{try{f(!0);const a=await L("/api/client/profile",{token:m});if(a.success&&a.data.client){const s=a.data.client;b(s),o({name:s.name||"",email:s.email||"",phone:s.phone||"",whatsapp:s.whatsapp||"",tax_card_number:s.tax_card_number||"",cr_number:s.cr_number||"",latitude:s.latitude||"",longitude:s.longitude||"",area_id:s.area_id||""}),(!s.latitude||!s.longitude)&&N()}}catch(a){c.show(a.message||"Failed to fetch profile","error")}finally{f(!1)}},i=a=>{const{name:s,value:k}=a.target;o(p=>({...p,[s]:k})),l[s]&&h(p=>({...p,[s]:""}))},w=()=>{const a={};return r.name.trim()||(a.name="Name is required"),r.email.trim()?/\S+@\S+\.\S+/.test(r.email)||(a.email="Email is invalid"):a.email="Email is required",r.phone.trim()||(a.phone="Phone number is required"),r.tax_card_number.trim()||(a.tax_card_number="Tax card number is required"),r.cr_number.trim()||(a.cr_number="Commercial registration number is required"),h(a),Object.keys(a).length===0},C=async a=>{if(a.preventDefault(),!!w())try{j(!0);const s=await D("/api/client/profile",{token:m,data:r});s.success&&(b(s.data.client),u(!1),c.show("Profile updated successfully!","success"))}catch(s){c.show(s.message||"Failed to update profile","error")}finally{j(!1)}},E=()=>{t&&o({name:t.name||"",email:t.email||"",phone:t.phone||"",whatsapp:t.whatsapp||"",tax_card_number:t.tax_card_number||"",cr_number:t.cr_number||"",latitude:t.latitude||"",longitude:t.longitude||"",area_id:t.area_id||""}),h({}),u(!1)},N=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(a=>{o(s=>({...s,latitude:a.coords.latitude.toString(),longitude:a.coords.longitude.toString()}))},a=>{c.show("Failed to get location: "+a.message,"error")}):c.show("Geolocation is not supported by this browser","error")};return!m||!g?e.jsx(A,{to:"/login-client",replace:!0}):g.role!=="client"?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-theme-bg py-12",children:e.jsxs("div",{className:"theme-card p-8 max-w-md text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-theme-text",children:"Access Denied"}),e.jsx("p",{className:"text-theme-text-secondary",children:"This page is only available for client users."})]})}):y?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-theme-bg",children:e.jsxs("div",{className:"theme-card p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("p",{className:"text-theme-text-secondary",children:"Loading profile..."})]})}):e.jsx("div",{className:"min-h-screen bg-theme-bg py-8 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"theme-card p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-theme-text",children:"Client Profile"}),e.jsx("p",{className:"text-theme-text-secondary mt-1",children:"Manage your account information"})]}),e.jsxs("div",{className:"flex gap-3",children:[n?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:E,className:"px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"Cancel"}),e.jsxs("button",{onClick:C,disabled:x,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium disabled:opacity-50 flex items-center gap-2",children:[x&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),x?"Saving...":"Save Changes"]})]}):e.jsx("button",{onClick:()=>u(!0),className:"theme-button px-6 py-2 font-medium",children:"Edit Profile"}),e.jsx("button",{onClick:v,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:"Logout"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"theme-card p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Personal Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Company Name *"}),n?e.jsx("input",{type:"text",name:"name",value:r.name,onChange:i,className:`theme-input w-full px-4 py-3 rounded-lg ${l.name?"border-red-500":""}`,placeholder:"Enter company name"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.name||"Not provided"}),l.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Email Address *"}),n?e.jsx("input",{type:"email",name:"email",value:r.email,onChange:i,className:`theme-input w-full px-4 py-3 rounded-lg ${l.email?"border-red-500":""}`,placeholder:"Enter email address"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.email||"Not provided"}),l.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Phone Number *"}),n?e.jsx("input",{type:"tel",name:"phone",value:r.phone,onChange:i,className:`theme-input w-full px-4 py-3 rounded-lg ${l.phone?"border-red-500":""}`,placeholder:"Enter phone number"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.phone||"Not provided"}),l.phone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"WhatsApp Number"}),n?e.jsx("input",{type:"tel",name:"whatsapp",value:r.whatsapp,onChange:i,className:"theme-input w-full px-4 py-3 rounded-lg",placeholder:"Enter WhatsApp number"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.whatsapp||"Not provided"})]})]})]}),e.jsxs("div",{className:"theme-card p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Business Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Tax Card Number *"}),n?e.jsx("input",{type:"text",name:"tax_card_number",value:r.tax_card_number,onChange:i,className:`theme-input w-full px-4 py-3 rounded-lg ${l.tax_card_number?"border-red-500":""}`,placeholder:"Enter tax card number"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.tax_card_number||"Not provided"}),l.tax_card_number&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.tax_card_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Commercial Registration Number *"}),n?e.jsx("input",{type:"text",name:"cr_number",value:r.cr_number,onChange:i,className:`theme-input w-full px-4 py-3 rounded-lg ${l.cr_number?"border-red-500":""}`,placeholder:"Enter CR number"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.cr_number||"Not provided"}),l.cr_number&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.cr_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Area ID"}),n?e.jsx("input",{type:"text",name:"area_id",value:r.area_id,onChange:i,className:"theme-input w-full px-4 py-3 rounded-lg",placeholder:"Enter area ID"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.area_id||"Not provided"})]})]})]}),e.jsxs("div",{className:"theme-card p-6 lg:col-span-2",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Location Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Latitude"}),n?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",name:"latitude",value:r.latitude,onChange:i,className:"theme-input flex-1 px-4 py-3 rounded-lg",placeholder:"Latitude"}),e.jsx("button",{type:"button",onClick:N,className:"px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",title:"Get current location",children:"üìç"})]}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.latitude||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Longitude"}),n?e.jsx("input",{type:"text",name:"longitude",value:r.longitude,onChange:i,className:"theme-input w-full px-4 py-3 rounded-lg",placeholder:"Longitude"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.longitude||"Not provided"})]})]})]}),e.jsxs("div",{className:"theme-card p-6 lg:col-span-2",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Account Status"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-theme-surface rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-theme-text",children:t?.id||"N/A"}),e.jsx("div",{className:"text-sm text-theme-text-secondary",children:"Client ID"})]}),e.jsxs("div",{className:"text-center p-4 bg-theme-surface rounded-lg",children:[e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${t?.is_active?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t?.is_active?"Active":"Pending"}),e.jsx("div",{className:"text-sm text-theme-text-secondary mt-1",children:"Status"})]}),e.jsxs("div",{className:"text-center p-4 bg-theme-surface rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-theme-text",children:t?.email_verified_at?"‚úì":"‚úó"}),e.jsx("div",{className:"text-sm text-theme-text-secondary",children:"Email Verified"})]})]})]})]})]})})}export{q as default};
