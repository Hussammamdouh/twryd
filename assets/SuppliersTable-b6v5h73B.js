import{R,r as s,a as _,j as e}from"./index-BBFhNgLA.js";import{g as I,d as V,p as y}from"./api-BUuAVsLY.js";import{C as z}from"./ConfirmModal-B6KWO9tH.js";import"./Modal-BllzMBoT.js";const U=function({token:i}){const[v,L]=s.useState([]),[M,b]=s.useState(!0),[j,k]=s.useState(""),[p,A]=s.useState(""),[x,$]=s.useState(""),[o,h]=s.useState(1),[c,P]=s.useState(10),[u,W]=s.useState(0),[w,B]=s.useState(0),[l,f]=s.useState({open:!1,action:"",supplier:null}),[n,N]=s.useState({}),d=_(),S=async()=>{b(!0),k("");try{const t=new URLSearchParams({page:o.toString(),per_page:c.toString()});x&&t.append("status",x),p&&t.append("search",p);const a=await I(`/api/v1/suppliers?${t.toString()}`,{token:i});let r=[],m={};a.data&&Array.isArray(a.data)?r=a.data:a.data&&a.data.data?(r=a.data.data,m=a.data.pagination||{}):a.data&&a.data.suppliers&&(r=a.data.suppliers,m=a.data.pagination||{}),L(r),W(m.last_page||1),B(m.total||r.length)}catch(t){k(t.message||"Failed to load suppliers"),d.show(t.message||"Failed to load suppliers","error")}finally{b(!1)}};s.useEffect(()=>{i&&S()},[i,o,c,x,p]);const C=async(t,a)=>{N(r=>({...r,[a.id]:!0}));try{switch(t){case"approve":await y(`/api/v1/suppliers/${a.id}/approve`,{token:i}),d.show("Supplier approved successfully","success");break;case"reject":await y(`/api/v1/suppliers/${a.id}/reject`,{token:i}),d.show("Supplier rejected successfully","success");break;case"toggle-status":await y(`/api/v1/suppliers/${a.id}/toggle-status`,{token:i}),d.show("Supplier status toggled successfully","success");break;case"verify-email":await y(`/api/v1/suppliers/${a.id}/verify-email`,{token:i}),d.show("Supplier email verified successfully","success");break;case"delete":await V(`/api/v1/suppliers/${a.id}`,{token:i}),d.show("Supplier deleted successfully","success");break;default:throw new Error("Invalid action")}await S()}catch(r){d.show(r.message||`Failed to ${t} supplier`,"error")}finally{N(r=>({...r,[a.id]:!1})),f({open:!1,action:"",supplier:null})}},g=(t,a)=>{f({open:!0,action:t,supplier:a})},F=()=>{f({open:!1,action:"",supplier:null})},T=(t,a)=>{switch(t){case"approve":return`Are you sure you want to approve ${a.name}?`;case"reject":return`Are you sure you want to reject ${a.name}?`;case"delete":return`Are you sure you want to delete ${a.name}? This action cannot be undone.`;case"toggle-status":return`Are you sure you want to ${a.is_active?"deactivate":"activate"} ${a.name}?`;default:return"Are you sure you want to perform this action?"}},E=t=>{A(t),h(1)},H=t=>{$(t),h(1)};return e.jsxs("div",{className:"w-full max-w-7xl mx-auto py-4 sm:py-8 px-1 sm:px-2 md:px-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-extrabold mb-4 sm:mb-8 text-primary-700 flex items-center gap-2 drop-shadow-sm",children:[e.jsx("span",{className:"inline-block bg-primary-100 text-primary-600 rounded-full px-2 sm:px-3 py-1 text-base sm:text-lg shadow",children:"Suppliers"}),e.jsx("span",{className:"text-theme-text-secondary font-normal text-base sm:text-lg",children:"Management"})]}),e.jsx("div",{className:"theme-card p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[e.jsx("div",{className:"flex-1 w-full sm:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-theme-text-muted pointer-events-none",children:e.jsxs("svg",{width:"18",height:"18",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",d:"M21 21l-3.5-3.5"})]})}),e.jsx("input",{type:"text",placeholder:"Search suppliers by name, email, or phone...",className:"theme-input pl-10 pr-4 py-2 w-full rounded-lg",value:p,onChange:t=>E(t.target.value),"aria-label":"Search suppliers"})]})}),e.jsxs("select",{className:"theme-input px-4 py-2 rounded-lg",value:x,onChange:t=>H(t.target.value),"aria-label":"Filter by status",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),e.jsxs("select",{className:"theme-input px-4 py-2 rounded-lg",value:c,onChange:t=>P(Number(t.target.value)),"aria-label":"Items per page",children:[e.jsx("option",{value:10,children:"10 per page"}),e.jsx("option",{value:25,children:"25 per page"}),e.jsx("option",{value:50,children:"50 per page"})]})]})}),e.jsxs("div",{className:"theme-card p-4",children:[e.jsx("div",{className:"overflow-x-auto rounded-lg",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Logo"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:M?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("svg",{className:"w-8 h-8 text-gray-400 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Loading suppliers..."})]})})}):j?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("svg",{className:"w-12 h-12 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("div",{className:"text-lg font-semibold text-red-500",children:j})]})})}):v.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("svg",{className:"w-12 h-12 text-gray-300 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v4a1 1 0 001 1h3m10-5v4a1 1 0 001 1h3m-7 4v4m0 0H7a2 2 0 01-2-2v-5a2 2 0 012-2h10a2 2 0 012 2v5a2 2 0 01-2 2h-5z"})}),e.jsx("div",{className:"text-lg font-semibold text-gray-500 dark:text-gray-400",children:"No suppliers found"}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500",children:"No suppliers match your current filters"})]})})}):v.map(t=>e.jsxs("tr",{className:"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-200 cursor-pointer",children:[e.jsxs("td",{className:"px-4 py-3",children:[t.logo?e.jsx("img",{src:t.logo.startsWith("http")?t.logo:`https://back.twryd.com/${t.logo}`,alt:t.name,className:"w-10 h-10 object-cover rounded-full border border-gray-200 dark:border-gray-700 shadow",onError:a=>{a.target.onerror=null,a.target.style.display="none",a.target.nextSibling.style.display="flex"}}):null,e.jsx("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 rounded-full flex items-center justify-center text-primary-700 dark:text-primary-300 font-bold text-sm",style:{display:t.logo?"none":"flex"},children:t.name?t.name.charAt(0).toUpperCase():"S"})]}),e.jsx("td",{className:"px-4 py-3 font-medium text-theme-text",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-theme-text break-all",children:t.email}),e.jsx("td",{className:"px-4 py-3 text-theme-text",children:t.phone}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${t.is_active?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":t.status==="pending"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":t.status==="rejected"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-gray-200 text-gray-500 dark:bg-gray-700 dark:text-gray-300"}`,children:t.status==="pending"?"Pending":t.status==="rejected"?"Rejected":t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>g("approve",t),disabled:n[t.id],className:"p-2 bg-green-100 hover:bg-green-200 dark:bg-green-900/30 dark:hover:bg-green-800/40 text-green-700 dark:text-green-300 rounded-lg transition-all duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-400 disabled:opacity-60",title:"Approve","aria-label":"Approve supplier",children:n[t.id]?e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M5 13l4 4L19 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("button",{onClick:()=>g("reject",t),disabled:n[t.id],className:"p-2 bg-red-100 hover:bg-red-200 dark:bg-red-900/30 dark:hover:bg-red-800/40 text-red-700 dark:text-red-300 rounded-lg transition-all duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-400 disabled:opacity-60",title:"Reject","aria-label":"Reject supplier",children:e.jsx("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 18L18 6M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]}),t.status!=="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>g("toggle-status",t),disabled:n[t.id],className:"p-2 bg-primary-100 hover:bg-primary-200 dark:bg-primary-900/30 dark:hover:bg-primary-800/40 text-primary-700 dark:text-primary-300 rounded-lg transition-all duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary-400 disabled:opacity-60",title:"Toggle Status","aria-label":"Toggle supplier status",children:e.jsx("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 4v16m8-8H4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),e.jsx("button",{onClick:()=>C("verify-email",t),disabled:n[t.id],className:"p-2 bg-purple-100 hover:bg-purple-200 dark:bg-purple-900/30 dark:hover:bg-purple-800/40 text-purple-700 dark:text-purple-300 rounded-lg transition-all duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-400 disabled:opacity-60",title:"Verify Email","aria-label":"Verify supplier email",children:e.jsx("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M16 12H8m4-4v8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]}),e.jsx("button",{onClick:()=>g("delete",t),disabled:n[t.id],className:"p-2 bg-red-100 hover:bg-red-200 dark:bg-red-900/30 dark:hover:bg-red-800/40 text-red-700 dark:text-red-300 rounded-lg transition-all duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-400 disabled:opacity-60",title:"Delete","aria-label":"Delete supplier",children:e.jsxs("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12ZM9 7V5a3 3 0 0 1 6 0v2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M10 11v6M14 11v6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})})]},t.id))})]})}),u>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-6 gap-4",children:[e.jsxs("div",{className:"text-sm text-theme-text-secondary",children:["Showing ",(o-1)*c+1," to ",Math.min(o*c,w)," of ",w," suppliers"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>h(t=>Math.max(1,t-1)),disabled:o===1,className:"theme-button-secondary px-3 py-2 rounded-lg font-semibold disabled:opacity-60","aria-label":"Previous page",children:"Previous"}),e.jsxs("span",{className:"px-3 py-2 text-sm font-semibold text-theme-text",children:["Page ",o," of ",u]}),e.jsx("button",{onClick:()=>h(t=>Math.min(u,t+1)),disabled:o===u,className:"theme-button px-3 py-2 rounded-lg font-semibold disabled:opacity-60","aria-label":"Next page",children:"Next"})]})]})]}),e.jsx(z,{open:l.open,title:`${l.action.charAt(0).toUpperCase()+l.action.slice(1)} Supplier`,message:l.supplier?T(l.action,l.supplier):"",onConfirm:()=>C(l.action,l.supplier),onCancel:F,loading:n[l.supplier?.id]})]})},K=R.memo(U);export{K as default};
