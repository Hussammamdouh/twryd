import{r,u as w,a as k,j as e}from"./index-BciHiggx.js";import{g as j}from"./api-BUuAVsLY.js";import{L as D}from"./ErrorBoundary-CU19MtL8.js";const S=s=>{if(!s)return"-";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"-"}},x=s=>s?parseFloat(s).toFixed(2):"0.00";function M(){const[s,m]=r.useState([]),[h,y]=r.useState([]),[N,p]=r.useState(!1),[d,u]=r.useState("supplier"),{token:a}=w(),f=k(),g=async()=>{try{const t=await j("/api/client-management/discounts",{token:a});m(t.data?.discounts||t.data||[])}catch(t){console.error("Failed to load supplier discounts:",t.message),f.show("Failed to load supplier discounts","error")}},b=async()=>{try{const t=await j("/api/client-management/products",{token:a}),n=(t.data?.products||t.data||[]).filter(c=>c.discount&&c.discount>0);y(n)}catch(t){console.error("Failed to load product discounts:",t.message),f.show("Failed to load product discounts","error")}},v=async()=>{p(!0);try{await Promise.all([g(),b()])}catch(t){console.error("Failed to load discounts:",t.message)}finally{p(!1)}};r.useEffect(()=>{a&&v()},[a]);const l=r.useMemo(()=>s.filter(t=>t.default_discount&&t.default_discount>0),[s]),o=r.useMemo(()=>h.filter(t=>t.discount&&t.discount>0),[h]);return N?e.jsx("div",{className:"min-h-screen bg-theme-bg p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx(D,{type:"dashboard"})})}):e.jsx("div",{className:"min-h-screen bg-theme-bg p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-theme-text mb-2",children:"My Discounts"}),e.jsx("p",{className:"text-theme-text-secondary",children:"View all discounts available to you from your suppliers"})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-theme-border",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{onClick:()=>u("supplier"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${d==="supplier"?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-theme-text-secondary hover:text-theme-text hover:border-theme-border"}`,children:["Supplier Discounts (",l.length,")"]}),e.jsxs("button",{onClick:()=>u("product"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${d==="product"?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-theme-text-secondary hover:text-theme-text hover:border-theme-border"}`,children:["Product Discounts (",o.length,")"]})]})})}),e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-sm border border-theme-border",children:d==="supplier"?e.jsxs("div",{children:[e.jsxs("div",{className:"px-6 py-4 border-b border-theme-border",children:[e.jsx("h2",{className:"text-lg font-semibold text-theme-text",children:"Supplier Discounts"}),e.jsx("p",{className:"text-sm text-theme-text-secondary mt-1",children:"Discounts applied to all products from specific suppliers"})]}),l.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"text-theme-text-muted mb-4",children:e.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),e.jsx("h3",{className:"text-lg font-medium text-theme-text mb-2",children:"No supplier discounts available"}),e.jsx("p",{className:"text-theme-text-secondary",children:"You don't have any supplier discounts at the moment."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-theme-border",children:[e.jsx("thead",{className:"bg-theme-surface",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider",children:"Supplier"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider",children:"Discount Percentage"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider",children:"Applied Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-theme-border",children:l.map(t=>e.jsxs("tr",{className:"hover:bg-theme-surface transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-primary-600 dark:text-primary-400",children:t.supplier?.name?.[0]?.toUpperCase()||"S"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-theme-text",children:t.supplier?.name||"Unknown Supplier"}),e.jsx("div",{className:"text-sm text-theme-text-secondary",children:t.supplier?.email||"No email"})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",children:[t.default_discount,"%"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-theme-text-secondary",children:S(t.created_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",children:"Active"})})]},t.id))})]})})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"px-6 py-4 border-b border-theme-border",children:[e.jsx("h2",{className:"text-lg font-semibold text-theme-text",children:"Product Discounts"}),e.jsx("p",{className:"text-sm text-theme-text-secondary mt-1",children:"Special discounts on specific products"})]}),o.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"text-theme-text-muted mb-4",children:e.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),e.jsx("h3",{className:"text-lg font-medium text-theme-text mb-2",children:"No product discounts available"}),e.jsx("p",{className:"text-theme-text-secondary",children:"No products with special discounts are currently available."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-theme-border",children:[e.jsx("thead",{className:"bg-theme-surface",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider",children:"Product"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider",children:"Supplier"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider",children:"Original Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider",children:"Discount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider",children:"Final Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-theme-border",children:o.map(t=>{const i=parseFloat(t.price)||0,n=i*t.discount/100,c=i-n;return e.jsxs("tr",{className:"hover:bg-theme-surface transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:e.jsx("svg",{className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-theme-text",children:t.name}),e.jsx("div",{className:"text-sm text-theme-text-secondary",children:t.category?.name||"No category"})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-theme-text",children:t.supplier?.name||"Unknown Supplier"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-theme-text-secondary",children:["$",x(i)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300",children:["-",t.discount,"%"]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-theme-text",children:["$",x(c)]}),e.jsxs("div",{className:"text-xs text-theme-text-secondary",children:["Save $",x(n)]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",children:"Active"})})]},t.id)})})]})})]})})]})})}export{M as default};
