import{u as S,a as D,r as d,j as e,g as P}from"./index-BBFhNgLA.js";import{g as A,a as L}from"./api-BUuAVsLY.js";function $(){const{user:b,logout:y,token:m}=S(),c=D(),[t,f]=d.useState(null),[_,j]=d.useState(!0),[x,N]=d.useState(!1),[i,h]=d.useState(!1),[r,o]=d.useState({name:"",email:"",phone:"",whatsapp:"",tax_card_number:"",cr_number:"",latitude:"",longitude:"",area_id:"",category_ids:[],key_persons:[]}),[l,u]=d.useState({});d.useEffect(()=>{m&&w()},[m]);const w=async()=>{try{j(!0);const s=await A("/api/supplier/profile",{token:m});if(s.success&&s.data){const a=s.data;f(a),o({name:a.name||"",email:a.email||"",phone:a.phone||"",whatsapp:a.whatsapp||"",tax_card_number:a.tax_card_number||"",cr_number:a.cr_number||"",latitude:a.latitude||"",longitude:a.longitude||"",area_id:a.area_id||"",category_ids:a.categories?.map(p=>p.id)||[],key_persons:a.key_persons||[]}),(!a.latitude||!a.longitude)&&v()}}catch(s){c.show(s.message||"Failed to fetch profile","error")}finally{j(!1)}},n=s=>{const{name:a,value:p}=s.target;o(g=>({...g,[a]:p})),l[a]&&u(g=>({...g,[a]:""}))},k=()=>{const s={};return r.name.trim()||(s.name="Name is required"),r.email.trim()?/\S+@\S+\.\S+/.test(r.email)||(s.email="Email is invalid"):s.email="Email is required",r.phone.trim()||(s.phone="Phone number is required"),r.tax_card_number.trim()||(s.tax_card_number="Tax card number is required"),r.cr_number.trim()||(s.cr_number="Commercial registration number is required"),u(s),Object.keys(s).length===0},C=async s=>{if(s.preventDefault(),!!k())try{N(!0);const a=await L("/api/supplier/profile",{token:m,data:r});a.success&&(f(a.data),h(!1),c.show("Profile updated successfully!","success"))}catch(a){c.show(a.message||"Failed to update profile","error")}finally{N(!1)}},E=()=>{t&&o({name:t.name||"",email:t.email||"",phone:t.phone||"",whatsapp:t.whatsapp||"",tax_card_number:t.tax_card_number||"",cr_number:t.cr_number||"",latitude:t.latitude||"",longitude:t.longitude||"",area_id:t.area_id||"",category_ids:t.categories?.map(s=>s.id)||[],key_persons:t.key_persons||[]}),u({}),h(!1)},v=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(s=>{o(a=>({...a,latitude:s.coords.latitude.toFixed(6),longitude:s.coords.longitude.toFixed(6)}))},s=>{c.show("Failed to get location: "+s.message,"error")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4}):c.show("Geolocation is not supported by this browser","error")};return!m||!b?e.jsx(P,{to:"/login-supplier",replace:!0}):b.role!=="supplier"?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-theme-bg py-12",children:e.jsxs("div",{className:"theme-card p-8 max-w-md text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-theme-text",children:"Access Denied"}),e.jsx("p",{className:"text-theme-text-secondary",children:"This page is only available for supplier users."})]})}):_?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-theme-bg",children:e.jsxs("div",{className:"theme-card p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("p",{className:"text-theme-text-secondary",children:"Loading profile..."})]})}):e.jsx("div",{className:"min-h-screen bg-theme-bg py-8 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"theme-card p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-theme-text",children:"Supplier Profile"}),e.jsx("p",{className:"text-theme-text-secondary mt-1",children:"Manage your account information"})]}),e.jsxs("div",{className:"flex gap-3",children:[i?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:E,className:"px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"Cancel"}),e.jsxs("button",{onClick:C,disabled:x,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium disabled:opacity-50 flex items-center gap-2",children:[x&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),x?"Saving...":"Save Changes"]})]}):e.jsx("button",{onClick:()=>h(!0),className:"theme-button px-6 py-2 font-medium",children:"Edit Profile"}),e.jsx("button",{onClick:y,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:"Logout"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"theme-card p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Personal Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Company Name *"}),i?e.jsx("input",{type:"text",name:"name",value:r.name,onChange:n,className:`theme-input w-full px-4 py-3 rounded-lg ${l.name?"border-red-500":""}`,placeholder:"Enter company name"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.name||"Not provided"}),l.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Email Address *"}),i?e.jsx("input",{type:"email",name:"email",value:r.email,onChange:n,className:`theme-input w-full px-4 py-3 rounded-lg ${l.email?"border-red-500":""}`,placeholder:"Enter email address"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.email||"Not provided"}),l.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Phone Number *"}),i?e.jsx("input",{type:"tel",name:"phone",value:r.phone,onChange:n,className:`theme-input w-full px-4 py-3 rounded-lg ${l.phone?"border-red-500":""}`,placeholder:"Enter phone number"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.phone||"Not provided"}),l.phone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"WhatsApp Number"}),i?e.jsx("input",{type:"tel",name:"whatsapp",value:r.whatsapp,onChange:n,className:"theme-input w-full px-4 py-3 rounded-lg",placeholder:"Enter WhatsApp number"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.whatsapp||"Not provided"})]})]})]}),e.jsxs("div",{className:"theme-card p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Business Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Tax Card Number *"}),i?e.jsx("input",{type:"text",name:"tax_card_number",value:r.tax_card_number,onChange:n,className:`theme-input w-full px-4 py-3 rounded-lg ${l.tax_card_number?"border-red-500":""}`,placeholder:"Enter tax card number"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.tax_card_number||"Not provided"}),l.tax_card_number&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.tax_card_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Commercial Registration Number *"}),i?e.jsx("input",{type:"text",name:"cr_number",value:r.cr_number,onChange:n,className:`theme-input w-full px-4 py-3 rounded-lg ${l.cr_number?"border-red-500":""}`,placeholder:"Enter CR number"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.cr_number||"Not provided"}),l.cr_number&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.cr_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Area ID"}),i?e.jsx("input",{type:"text",name:"area_id",value:r.area_id,onChange:n,className:"theme-input w-full px-4 py-3 rounded-lg",placeholder:"Enter area ID"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.area_id||"Not provided"})]})]})]}),e.jsxs("div",{className:"theme-card p-6 lg:col-span-2",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Location Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Latitude"}),i?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",name:"latitude",value:r.latitude,onChange:n,className:"theme-input flex-1 px-4 py-3 rounded-lg",placeholder:"Latitude"}),e.jsx("button",{type:"button",onClick:v,className:"px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",title:"Get current location",children:"üìç"})]}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.latitude||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text mb-2",children:"Longitude"}),i?e.jsx("input",{type:"text",name:"longitude",value:r.longitude,onChange:n,className:"theme-input w-full px-4 py-3 rounded-lg",placeholder:"Longitude"}):e.jsx("div",{className:"px-4 py-3 bg-theme-surface rounded-lg text-theme-text",children:t?.longitude||"Not provided"})]})]})]}),e.jsxs("div",{className:"theme-card p-6 lg:col-span-2",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Account Status"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-theme-surface rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-theme-text",children:t?.id||"N/A"}),e.jsx("div",{className:"text-sm text-theme-text-secondary",children:"Supplier ID"})]}),e.jsxs("div",{className:"text-center p-4 bg-theme-surface rounded-lg",children:[e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${t?.is_active?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300"}`,children:t?.is_active?"Active":"Pending"}),e.jsx("div",{className:"text-sm text-theme-text-secondary mt-1",children:"Status"})]}),e.jsxs("div",{className:"text-center p-4 bg-theme-surface rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-theme-text",children:t?.email_verified_at?"‚úì":"‚úó"}),e.jsx("div",{className:"text-sm text-theme-text-secondary",children:"Email Verified"})]})]})]}),t?.logo_url&&e.jsxs("div",{className:"theme-card p-6 lg:col-span-2",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Company Logo"}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:t.logo_url,alt:"Company Logo",className:"w-32 h-32 object-contain rounded-lg border border-theme-border"})})]}),t?.categories&&t.categories.length>0&&e.jsxs("div",{className:"theme-card p-6 lg:col-span-2",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Business Categories"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:t.categories.map((s,a)=>e.jsxs("div",{className:"p-3 bg-primary-50 dark:bg-primary-900/30 rounded-lg border border-primary-200 dark:border-primary-700",children:[e.jsx("div",{className:"font-medium text-primary-900 dark:text-primary-100",children:s.name}),s.description&&e.jsx("div",{className:"text-sm text-primary-700 dark:text-primary-300 mt-1",children:s.description})]},a))})]}),t?.key_persons&&t.key_persons.length>0&&e.jsxs("div",{className:"theme-card p-6 lg:col-span-2",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Key Personnel"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.key_persons.map((s,a)=>e.jsxs("div",{className:"p-4 bg-theme-surface rounded-lg border border-theme-border",children:[e.jsx("div",{className:"font-medium text-theme-text mb-2",children:s.name}),e.jsxs("div",{className:"text-sm text-theme-text-secondary space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Role:"})," ",s.role||s.type]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Phone:"})," ",s.phone]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",s.email]})]})]},a))})]}),(t?.tax_card_file_url||t?.cr_file_url)&&e.jsxs("div",{className:"theme-card p-6 lg:col-span-2",children:[e.jsx("h2",{className:"text-xl font-bold text-theme-text mb-6",children:"Business Documents"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t?.tax_card_file_url&&e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"font-medium text-green-900 mb-2",children:"Tax Card Document"}),e.jsx("a",{href:t.tax_card_file_url,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-800 text-sm underline",children:"View Document"})]}),t?.cr_file_url&&e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"font-medium text-blue-900 mb-2",children:"Commercial Registration Document"}),e.jsx("a",{href:t.cr_file_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline",children:"View Document"})]})]})]})]})]})})}export{$ as default};
